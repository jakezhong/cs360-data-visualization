<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta http-equiv="X-UA-Compatible" content="ie=edge">
		<link rel="icon" type="image/x-icon" href="assets/img/favicon.ico">
		<link href="https://fonts.googleapis.com/css?family=Roboto+Mono%7CArvo:400%7CRoboto:300,400,500,700%7CCookie" rel="stylesheet">
		<link rel="stylesheet" href="../../ui/vendor/css/fontawesome.min.css">
		<link rel="stylesheet" href="../../ui/vendor/perfect-scrollbar.css">
		<link rel="stylesheet" href="../../ui/css/style.css">
		<script src="../../ui/vendor/d3.v5.min.js"></script>
		<script type="text/javascript" src="https://d3js.org/topojson.v3.min.js"></script>
		<title>CS360/560 Data Visualization</title>
	<style>
		#svg-container {
			position: relative;
			overflow: hidden;
		}
		
		.svg-row {
			display: flex;
			justify-content: space-between;
		}
		
		#panel-trigger {
			width: 100%;
			margin-bottom: 20px;
		}
		
		#panel-trigger select {
			display: block;
			width: 100%;
			font-size: 12px;
		}
		
        .states {
            fill: #aaa;
        }

        .states .active {
            display:none;
        }

        .state-borders {
            fill: none;
            stroke: #000;
            stroke-width: 0.5px;
            stroke-linejoin: round;
            stroke-linecap: round;
            pointer-events: none;
        }
		
		.counties {
            fill: #aaa;
		}

		.county-borders {
			fill: none;
			stroke: #fff;
			stroke-width: 0.2px;
			stroke-linejoin: round;
			stroke-linecap: round;
			pointer-events: none;
		}
		
		.detail-info {
			background-color: rgba(0,0,0,0.8);
			width: 300px;
			color: #fff;
			font-size: 11px;
			padding: 8px;
		}
		.info-table {
			width: 100%;
		}
		
		.info-table th {
			white-space: nowrap;
			padding: 2px;
		}
		
		.info-table td {
			white-space: nowrap;
			padding: 2px;
		}
		
		.info-table tr {
			vertical-align: top;
		}
	</style>
	</head>
	<body>
		<div class="full-page">
			<div class="sidebar-container">
				<aside  class="sidebar sidebar-left sidebar-fixed sidebar-dark">
					<div class="scroll">
						<div class="sidebar-header text-white bg-info">
							<div class="sidebar-brand d-flex justify-content-between align-items-center">
								<div class="title text-truncate">
									Data Visulization
								</div>
								<div class="logo align-items-center justify-content-around">
									<i class="material-icons">all_inclusive</i>
								</div>
							</div>
						</div>
						<div class="sidebar-nav-container">
							<ul class="list-nav sidebar-nav list-nav-dark list-nav-dark-info">
								<li class="list-nav-group-title">
									<span>
									  FINAL PROJECT
									</span>
								</li>
								<li class="list-nav-item">
									<a href="../../" class="list-nav-link">
									  <span class="list-nav-icon">
										<i class="material-icons">home</i>
									  </span>
									  <span class="list-nav-label">Home</span>
									</a>
								</li>
								<li class="list-nav-item">
									<a href="#" class="list-nav-link">
									  	<span class="list-nav-icon">
											<i class="material-icons">folder_open</i>
									  	</span>
									  	<span class="list-nav-label">Homework 1</span>
									  	<span class="list-nav-expand">
											<i class="material-icons">add</i>
									  	</span>
									</a>
									<ul class="list-nav-child">
										<li class="list-nav-item list-nav-child-item">
										  <a href="../homework1/overview.html" class="list-nav-link">
											<span class="list-nav-icon list-nav-icon-sm">
											  <i class="material-icons">keyboard_arrow_right</i>
											</span>
											<span class="list-nav-label">Overview</span>
										  </a>
										</li>
										<li class="list-nav-item list-nav-child-item">
										  <a href="../homework1/prototypes.html" class="list-nav-link">
											<span class="list-nav-icon list-nav-icon-sm">
											  <i class="material-icons">keyboard_arrow_right</i>
											</span>
											<span class="list-nav-label">Tableau Prototypes</span>
										  </a>
										</li>
										<li class="list-nav-item list-nav-child-item">
										  <a href="../homework1/d3-bar.html" class="list-nav-link">
											<span class="list-nav-icon list-nav-icon-sm">
											  <i class="material-icons">keyboard_arrow_right</i>
											</span>
											<span class="list-nav-label">D3 Implementations</span>
										  </a>
										</li>
										<li class="list-nav-item list-nav-child-item">
										  <a href="../homework1/requirements.html" class="list-nav-link">
											<span class="list-nav-icon list-nav-icon-sm">
											  <i class="material-icons">keyboard_arrow_right</i>
											</span>
											<span class="list-nav-label">Requirements</span>
										  </a>
										</li>
									</ul>
								</li>
								<li class="list-nav-item">
									<a href="#" class="list-nav-link">
									  	<span class="list-nav-icon">
											<i class="material-icons">folder_open</i>
									  	</span>
									  	<span class="list-nav-label">Homework 2</span>
									  	<span class="list-nav-expand">
											<i class="material-icons">add</i>
									  	</span>
									</a>
									<ul class="list-nav-child">
										<li class="list-nav-item list-nav-child-item">
										  <a href="../homework2/overview.html" class="list-nav-link">
											<span class="list-nav-icon list-nav-icon-sm">
											  <i class="material-icons">keyboard_arrow_right</i>
											</span>
											<span class="list-nav-label">Overview</span>
										  </a>
										</li>
										<li class="list-nav-item list-nav-child-item">
										  <a href="../homework2/scatterplot-matrix.html" class="list-nav-link">
											<span class="list-nav-icon list-nav-icon-sm">
											  <i class="material-icons">keyboard_arrow_right</i>
											</span>
											<span class="list-nav-label">Scatterplot Matrix</span>
										  </a>
										</li>
										<li class="list-nav-item list-nav-child-item">
										  <a href="../homework2/requirements.html" class="list-nav-link">
											<span class="list-nav-icon list-nav-icon-sm">
											  <i class="material-icons">keyboard_arrow_right</i>
											</span>
											<span class="list-nav-label">Requirements</span>
										  </a>
										</li>
									</ul>
								</li>
								<li class="list-nav-item">
									<a href="#" class="list-nav-link">
									  	<span class="list-nav-icon">
											<i class="material-icons">folder_open</i>
									  	</span>
									  	<span class="list-nav-label">Homework 3</span>
									  	<span class="list-nav-expand">
											<i class="material-icons">add</i>
									  	</span>
									</a>
									<ul class="list-nav-child">
										<li class="list-nav-item list-nav-child-item">
										  <a href="../homework3/overview.html" class="list-nav-link">
											<span class="list-nav-icon list-nav-icon-sm">
											  <i class="material-icons">keyboard_arrow_right</i>
											</span>
											<span class="list-nav-label">Overview</span>
										  </a>
										</li>
										<li class="list-nav-item list-nav-child-item">
										  <a href="../homework3/implementation.html" class="list-nav-link">
											<span class="list-nav-icon list-nav-icon-sm">
											  <i class="material-icons">keyboard_arrow_right</i>
											</span>
											<span class="list-nav-label">Implementations</span>
										  </a>
										</li>
										<li class="list-nav-item list-nav-child-item">
										  <a href="../homework3/requirements.html" class="list-nav-link">
											<span class="list-nav-icon list-nav-icon-sm">
											  <i class="material-icons">keyboard_arrow_right</i>
											</span>
											<span class="list-nav-label">Requirements</span>
										  </a>
										</li>
									</ul>
								</li>
								<li class="list-nav-item">
									<a href="#" class="list-nav-link">
									  	<span class="list-nav-icon">
											<i class="material-icons">folder_open</i>
									  	</span>
									  	<span class="list-nav-label">Homework 4</span>
									  	<span class="list-nav-expand">
											<i class="material-icons">add</i>
									  	</span>
									</a>
									<ul class="list-nav-child">
										<li class="list-nav-item list-nav-child-item">
										  <a href="../homework4/overview.html" class="list-nav-link">
											<span class="list-nav-icon list-nav-icon-sm">
											  <i class="material-icons">keyboard_arrow_right</i>
											</span>
											<span class="list-nav-label">Overview</span>
										  </a>
										</li>
										<li class="list-nav-item list-nav-child-item">
										  <a href="../homework4/implementation.html" class="list-nav-link">
											<span class="list-nav-icon list-nav-icon-sm">
											  <i class="material-icons">keyboard_arrow_right</i>
											</span>
											<span class="list-nav-label">Implementations</span>
										  </a>
										</li>
										<li class="list-nav-item list-nav-child-item">
										  <a href="../homework4/requirements.html" class="list-nav-link">
											<span class="list-nav-icon list-nav-icon-sm">
											  <i class="material-icons">keyboard_arrow_right</i>
											</span>
											<span class="list-nav-label">Requirements</span>
										  </a>
										</li>
									</ul>
								</li>
								<li class="list-nav-item">
									<a href="#" class="list-nav-link">
									  	<span class="list-nav-icon">
											<i class="material-icons">folder_open</i>
									  	</span>
									  	<span class="list-nav-label">Midterm</span>
									  	<span class="list-nav-expand">
											<i class="material-icons">add</i>
									  	</span>
									</a>
									<ul class="list-nav-child">
										<li class="list-nav-item list-nav-child-item">
										  <a href="../midterm/prototype.html" class="list-nav-link">
											<span class="list-nav-icon list-nav-icon-sm">
											  <i class="material-icons">keyboard_arrow_right</i>
											</span>
											<span class="list-nav-label">Prototype</span>
										  </a>
										</li>
										<li class="list-nav-item list-nav-child-item">
										  <a href="../midterm/implementation.html" class="list-nav-link">
											<span class="list-nav-icon list-nav-icon-sm">
											  <i class="material-icons">keyboard_arrow_right</i>
											</span>
											<span class="list-nav-label">Implementation</span>
										  </a>
										</li>
									</ul>
								</li>
								<li class="list-nav-item">
									<a href="#" class="list-nav-link">
									  	<span class="list-nav-icon">
											<i class="material-icons">folder_open</i>
									  	</span>
									  	<span class="list-nav-label">Final</span>
									  	<span class="list-nav-expand">
											<i class="material-icons">add</i>
									  	</span>
									</a>
									<ul class="list-nav-child">
										<li class="list-nav-item list-nav-child-item">
										  <a href="overview.html" class="list-nav-link">
											<span class="list-nav-icon list-nav-icon-sm">
											  <i class="material-icons">keyboard_arrow_right</i>
											</span>
											<span class="list-nav-label">Overview</span>
										  </a>
										</li>
										<li class="list-nav-item list-nav-child-item">
										  <a href="about.html" class="list-nav-link">
											<span class="list-nav-icon list-nav-icon-sm">
											  <i class="material-icons">keyboard_arrow_right</i>
											</span>
											<span class="list-nav-label">About</span>
										  </a>
										</li>
										<li class="list-nav-item list-nav-child-item">
										  <a href="dataset.html" class="list-nav-link">
											<span class="list-nav-icon list-nav-icon-sm">
											  <i class="material-icons">keyboard_arrow_right</i>
											</span>
											<span class="list-nav-label">Dataset</span>
										  </a>
										</li>
										<li class="list-nav-item list-nav-child-item">
										  <a href="alpha.html" class="list-nav-link">
											<span class="list-nav-icon list-nav-icon-sm">
											  <i class="material-icons">keyboard_arrow_right</i>
											</span>
											<span class="list-nav-label">Alpha Release</span>
										  </a>
										</li>
										<li class="list-nav-item list-nav-child-item">
										  <a href="beta.html" class="list-nav-link">
											<span class="list-nav-icon list-nav-icon-sm">
											  <i class="material-icons">keyboard_arrow_right</i>
											</span>
											<span class="list-nav-label">Beta Release</span>
										  </a>
										</li>
										<li class="list-nav-item list-nav-child-item">
										  <a href="final.html" class="list-nav-link">
											<span class="list-nav-icon list-nav-icon-sm">
											  <i class="material-icons">keyboard_arrow_right</i>
											</span>
											<span class="list-nav-label">Final Release</span>
										  </a>
										</li>
										<li class="list-nav-item list-nav-child-item">
										  <a href="requirements.html" class="list-nav-link">
											<span class="list-nav-icon list-nav-icon-sm">
											  <i class="material-icons">keyboard_arrow_right</i>
											</span>
											<span class="list-nav-label">Requirements</span>
										  </a>
										</li>
									</ul>
								</li>
							</ul>
						</div>
					</div>
				</aside>
			</div>
			<div class="page">
				<div class="topbar-container">
					<nav class="navbar bg-white text-secondary navbar-expand-sm py-0 topbar fixed">
						<button class="btn btn-flat-secondary btn-sm btn-icon mr-1 no-shadow d-none d-xl-block sidebar-toggle">
							<i class="material-icons">menu</i>
						</button>
						<button class="btn btn-flat-secondary btn-sm btn-icon mr-1 d-xl-none no-shadow sidebar-hide">
							<i class="material-icons">menu</i>
						</button>

						<div class="navbar-text ml-3 d-none d-sm-block">
							<h5 class="m-0 text-dark">Final Project</h5>
						</div>

						<div class="ml-auto d-sm-flex ml-3">
							<ul class="navbar-nav">
								<li class="nav-item no-caret">
									<a href="../about.html" class="nav-link text-center">About</a>
								</li>
								<li class="nav-item no-caret">
									<a href="../resources.html" class="nav-link text-center">Resources</a>
								</li>
								<li class="nav-item no-caret">
									<a href="https://jakezhong.com" target="_blank" class="nav-link text-center">
										<i class="far fa-globe"></i>
									</a>
								</li>
								<li class="nav-item no-caret">
									<a href="https://github.com/jakezhong" target="_blank" class="nav-link text-center">
										<i class="fab fa-github"></i>
									</a>
								</li>
								<li class="nav-item no-caret">
									<a href="https://www.linkedin.com/in/jake-zhong/" target="_blank" class="nav-link text-center">
										<i class="fab fa-linkedin-in"></i>
									</a>
								</li>
								<li class="nav-item no-caret">
									<a href="https://www.instagram.com/jakezhong_" target="_blank" class="nav-link text-center">
										<i class="fab fa-instagram"></i>
									</a>
								</li>
								<li class="nav-item no-caret">
									<a href="https://www.facebook.com/jksakura" target="_blank" class="nav-link text-center">
										<i class="fab fa-facebook"></i>
									</a>
								</li>
							</ul>
						</div>
					</nav>
				</div>
				<div class="page-content">
					<section class="section">
						<div class="container">
							<!-- Begin page content -->
							<hr class="space"/>
							<h3 class="section-title">D3 Implementations</h3>
							<div class="card work-images">
								<div class="card-body card-body-p">
									<div class="chart-container">
										<div class="implementation-container">
											<h4 class="section-title top-space">D3 Hierarchical Pack of Fire department Call Records in Feb 2020 by Neighborhoods and Call Types.</h4>
											<div id="svg-container">
												<div class="svg-row">
													<div class="svg-col">
														<svg id="map">
															<g id="basemap">
																<g id="us-map">
																	<g id="states"></g>
																	<g id="counties"></g>
																	<g id="cities"></g>
																</g>
															</g>
															<g id="legend" pointer-events="none"></g>
															<g id="detail-panel" pointer-events="none"></g>
														</svg>
													</div>
													<div class="svg-col">
														<div id="panel">
															<div id="panel-trigger">
																<select>
																	<option>Bar - Average Price of Houses (2015 - 2020)</option>
																	<option>Bar - Count of House Sales (2015 - 2020)</option>
																	<option>Line - Average Price Trend (2015 - 2020)</option>
																	<option>Line - Count of House Sales Trend (2015 - 2020)</option>
																</select>
															</div>
															<div class="bar-price">
																<svg id="bar-price"></svg>
															</div>
															<div class="bar-count">
																<svg id="bar-count"></svg>
															</div>
															<div class="line-price">
																<svg id="line-price"></svg>
															</div>
															<div class="line-count">
																<svg id="line-count"></svg>
															</div>
															<div class="details">
																<div id="detail-1">
																	<div class="detail-1-bar-1">
																		<svg id="detail-1-bar-1"></svg>
																	</div>
																	<div class="detail-1-bar-2 space">
																		<svg id="detail-1-bar-2"></svg>
																	</div>
																	<hr class="space">
																	<div class="detail-1-bar-3 space">
																		<svg id="detail-1-line-1"></svg>
																	</div>
																	<div class="detail-1-bar-4 space">
																		<svg id="detail-1-line-2"></svg>
																	</div>
																</div>
																<div id="detail-2">
																	<svg id="detail-2-bar-1"></svg>
																	<svg id="detail-2-bar-2"></svg>
																	<svg id="detail-2-line-1"></svg>
																	<svg id="detail-2-line-2"></svg>
																</div>
																<div id="detail-3">
																	<svg id="detail-3-bar-1"></svg>
																	<svg id="detail-3-bar-2"></svg>
																	<svg id="detail-3-line-1"></svg>
																	<svg id="detail-3-line-2"></svg>
																</div>
															</div>
														</div>
													</div>
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>
					  		<!-- End page content -->
						</div>
					</section>
				</div>
			</div>
		</div>
		<script>
			let bayareaCitiesList = ["Albany", "American Canyon", "Antioch", "Atherton", "Belmont", "Belvedere", "Benicia", "Berkeley", "Brentwood", "Brisbane", "Burlingame", "Calistoga", "Campbell", "Clayton", "Cloverdale", "Colma", "Concord", "Corte Madera", "Cotati", "Cupertino", "Daly City", "Danville", "Dixon", "Dublin", "East Palo Alto", "El Cerrito", "Emeryville", "Fairfax", "Foster City", "Fremont", "Gilroy", "Half Moon Bay", "Hayward", "Healdsburg", "Hercules", "Hillsborough", "Lafayette", "Larkspur", "Livermore", "Los Altos", "Los Altos Hills", "Los Gatos", "Martinez", "Menlo Park", "Mill Valley", "Millbrae", "Milpitas", "Monte Sereno", "Moraga", "Morgan Hill", "Mountain View", "Napa", "Newark", "Novato", "Oakland", "Oakley", "Orinda", "Pacifica", "Palo Alto", "Petaluma", "Piedmont", "Pinole", "Pittsburg", "Pleasant Hill", "Pleasanton", "Portola Valley", "Redwood City", "Richmond", "Rio Vista", "Rohnert Park", "Ross", "St. Helena", "San Anselmo", "San Carlos", "San Francisco", "San Jose", "San Leandro", "San Mateo", "San Pablo", "San Rafael", "San Ramon", "Santa Clara", "Santa Rosa", "Saratoga", "Sausalito", "Sebastopol", "Sonoma", "Suisun City", "Sunnyvale", "Tiburon", "Union City", "Vacaville", "Vallejo", "Walnut Creek", "Windsor", "Woodside", "Yountville"];
			
			let records = {};
			
			let count = {
				"2015": 0,
				"2016": 0,
				"2017": 0,
				"2018": 0,
				"2019": 0,
				"2020": 0,
				"total": 0,
				"yearMaximun": 0,
				"yearMinimun": Number.MAX_VALUE,
				"yearMaximunCity": "",
				"yearMaximunYear": "",
				"yearMinimunCity": "",
				"yearMinimunYear": "",
				"average": 0,
				"totalMaximun": 0,
				"totalMinimun": Number.MAX_VALUE
			}
			
			let price = {
				"2015": 0,
				"2016": 0,
				"2017": 0,
				"2018": 0,
				"2019": 0,
				"2020": 0,
				"total": 0,
				"yearMaximun": 0,
				"yearMinimun": Number.MAX_VALUE,
				"average": 0,
				"yearMaximunCity": "",
				"yearMaximunYear": "",
				"yearMinimunCity": "",
				"yearMinimunYear": "",
				"totalMaximun": 0,
				"totalMinimun": Number.MAX_VALUE
			}
			
			let date = [2015, 2016, 2017, 2018, 2019, 2020];
			
			let data = [];
			
			bayareaCitiesList.forEach(function(elem, index) {
				let record = {
					"id": -1,
					"name": "",
					"latitude": "",
					"longitude": "",
					"2015-count": 0,
					"2016-count": 0,
					"2017-count": 0,
					"2018-count": 0,
					"2019-count": 0,
					"2020-count": 0,
					"2015-2020-count": 0,
					"2015-price": 0,
					"2016-price": 0,
					"2017-price": 0,
					"2018-price": 0,
					"2019-price": 0,
					"2020-price": 0,
					"2015-2020-price": 0
				};
				
				record["name"] = elem;
				record["id"] = index;
				records[elem] = record;
			});

//			Format Example: 
//			
//			records{"city": record, "city": record, "city": record, "city": record...];
//			
//			record = {
//				"name": "Albany",
//				"2015-price": 200000,
//				"2016-price": 300000,
//				"2017-price": 400000,
//				"2018-price": 500000,
//				"2019-price": 600000,
//				"2020-price": 700000,
//				"2015-2020-price": 2700000,
//				"2015-count": 100,
//				"2016-count": 200,
//				"2017-count": 300,
//				"2018-count": 400,
//				"2019-count": 500,
//				"2020-count": 600,
//				"2015-2020-count": 2100,
//			}
//
//			prices = {
//				"2015": 1000000,
//				"2016": 1500000,
//				"2017": 2000000,
//				"2018": 2500000,
//				"2019": 3000000,
//				"2020": 3200000
//			}
//			
//			data = [record, record, record...];
			let colorMain = "rgb(0, 137, 255)";
			let colorBlack = "rgb(0, 0, 0)";
			let colorWhite = "rgb(255, 255, 255)";
			let colorPrimary = "rgb(32, 206, 0)";
			let colorSecondary = "rgb(255, 137, 0)";
			let colorGray = "rgb(0, 137, 255)";
			
			loadSaleCount();
			
			function loadSaleCount() {
				d3.csv("data/Sale_Counts_Seas_Adj_City.csv").then(function(data) {
					if (data == undefined) {
						console.log("Failed to load file");
						
						return;
					}
					
					data.forEach(function(d) {
						let sum = 0;

						if (records[d.RegionName] != undefined) {
							for (let i = 2015; i < 2021; i++) {
								if (i === 2020) {
									records[d.RegionName][i+"-count"] = parseInt((~~parseInt(d[i+"-01"]) + ~~parseInt(d[i+"-02"]) + ~~parseInt(d[i+"-03"])) / 3);

									break;
								}
								records[d.RegionName][i+"-count"] = parseInt((~~parseInt(d[i+"-01"]) + ~~parseInt(d[i+"-02"]) + ~~parseInt(d[i+"-03"]) + ~~parseInt(d[i+"-04"]) + ~~parseInt(d[i+"-05"]) + ~~parseInt(d[i+"-06"]) + ~~parseInt(d[i+"-07"]) + ~~parseInt(d[i+"-08"]) + ~~parseInt(d[i+"-09"]) + ~~parseInt(d[i+"-10"]) + ~~parseInt(d[i+"-11"]) + ~~parseInt(d[i+"-12"])) / 12);
							}


							for (let i = 2015; i < 2021; i++) {
								sum += records[d.RegionName][i+"-count"];
								
								count[i] += records[d.RegionName][i+"-count"];
								
								if (count.maximun < records[d.RegionName][i+"-count"]) {
									count.maximun = records[d.RegionName][i+"-count"];
									count.maximunCity = records[d.RegionName];
									count.maximunYear = i;
								} else if(count.minimun > records[d.RegionName][i+"-count"]) {
									count.minimun = records[d.RegionName][i+"-count"];
									count.minimunCity = records[d.RegionName];
									count.minimunYear = i;
								}
							}

							records[d.RegionName]["2015-2020-count"] = sum;
							
							if (count.totalMaximun < sum) {
								count.totalMaximun = sum;
							} else if(count.totalMinimun > sum) {
								count.totalMinimun = sum;
							}
							
							count.total += sum;
						}
					});
					
					count.average = ~~parseInt(count.total) / bayareaCitiesList.length;
				});
				loadAllHomes();
				loadCities();
			};
			
			function loadAllHomes() {
				d3.csv("data/City_Zhvi_AllHomes.csv").then(function(data) {
					if (data == undefined) {
						console.log("Failed to load file");

						return;
					}
					data.forEach(function(d) {
						if (records[d.RegionName] != undefined) {
							let sum = 0, average;
							if (records[d.RegionName]["2015-2020-count"] !== 0) {
								for (let i = 2015; i < 2021; i++) {
									if (i === 2020) {
										records[d.RegionName][i+"-price"] = parseInt((~~parseInt(d[i+"-01"]) + ~~parseInt(d[i+"-02"]) + ~~parseInt(d[i+"-03"])) / 3);

										break;
									}
									records[d.RegionName][i+"-price"] = parseInt((~~parseInt(d[i+"-01"]) + ~~parseInt(d[i+"-02"]) + ~~parseInt(d[i+"-03"]) + ~~parseInt(d[i+"-04"]) + ~~parseInt(d[i+"-05"]) + ~~parseInt(d[i+"-06"]) + ~~parseInt(d[i+"-07"]) + ~~parseInt(d[i+"-08"]) + ~~parseInt(d[i+"-09"]) + ~~parseInt(d[i+"-10"]) + ~~parseInt(d[i+"-11"]) + ~~parseInt(d[i+"-12"])) / 12);
								}

								for (let i = 2015; i < 2021; i++) {
									sum += records[d.RegionName][i+"-price"];
									
									price[i] = records[d.RegionName][i+"-price"];
									
									if (price.maximun < records[d.RegionName][i+"-price"]) {
										price.maximun = records[d.RegionName][i+"-price"];
										price.maximunCity = records[d.RegionName];
										price.maximunYear = i;
									} else if(price.minimun > records[d.RegionName][i+"-price"]) {
										price.minimun = records[d.RegionName][i+"-price"];
										price.minimunCity = records[d.RegionName];
										price.minimunYear = i;
									}
								}

								average = parseInt(sum / 6);

								records[d.RegionName]["2015-2020-price"] = average;
								
								if (price.totalMaximun < average) {
									price.totalMaximun = average;
								} else if(price.totalMinimun > average) {
									price.totalMinimun = average;
								}

								price.total += average;
							}
						}
					});
					price.average = ~~parseInt(price.total) / bayareaCitiesList.length;
			
					draw();
				});
			};
			
			function loadCities() {
				d3.csv("data/City_Coordinates.csv").then(function(data) {
					if (data == undefined) {
						console.log("Failed to load file");

						return;
					}
					data.forEach(function(d) {
						if (records[d.RegionName] != undefined) {
							records[d.RegionName]["latitude"] = d.Latitude != "" ? d.Latitude : 0;
							records[d.RegionName]["longitude"] = d.Longitude != "" ? d.Longitude : 0;
						}
					});
				});
				
				// Convert the records object to an array
				data = Object.keys(records).map(function(key) { 
					return records[key]; 
				});
			}
			
			function draw() {
				const container = d3.select("#svg-container");

				let containerWidth = 680, containerHeight = 600;
				
				const g = {
					usMap: container.select("g#us-map"),
					tooltip: container.select("g#tooltip"),
					legend: container.select("g#legend"),
					details: container.select("g#detail-panel"),
					states: container.select("g#states"),
					counties: container.select("g#counties"),
					cities: container.select("g#cities")
				};

				const details = g.details
					.append("foreignObject")
					.attr("id", "details")
					.attr("width", containerWidth)
					.attr("height", containerHeight)
					.attr("x", 0)
					.attr("y", 0);

				const body = details.append("xhtml:div")
					.attr("class", "detail-info")
					.html("<p>N/A</p>");

				details.style("visibility", "hidden");
				
				drawMap();
				drawPanel();
				
				function drawMap() {
					d3.json("data/counties-albers-10m.json").then(drawElements);

					console.log(data);
					let width = 680, height = 600;

					// Declare and initialize all graph elements
					const map = d3
						.select("svg#map")
						.attr("x", 0)
						.attr("width", width)
						.attr("height", height)
						.attr("viewBox", "0 0 "+width+" "+height);

					let basemap = map.select("g#basemap");

					g.usMap.style("transform", "translate(0, -1800px) scale(8)");

					// Zooming for the bars
					const extent = [0, [width, height]];

					basemap.call(d3.zoom()
						.scaleExtent([1, 4])
						.extent([[0, 0], [width, height]])
						.on("zoom", zoomed));

					function zoomed() {
						basemap.attr('transform', d3.event.transform);
					}

					function drawElements(json) {
						// D3 Projection
						let projection = d3.geoAlbersUsa().scale(1300).translate([487.5, 305]);     // scale things down so see entire US

						// Define path generator
						let path = d3.geoPath();  // tell path generator to use albersUsa projection

						g.states.append("g")
							.attr("class", "states")
							.selectAll("path")
							.data(topojson.feature(json, json.objects.states).features)
							.enter().append("path")
							.attr("d", path)
							.attr("class", "state");


						g.states.append("path")
							.datum(topojson.mesh(json, json.objects.states, function(a, b) { return a !== b; }))
							.attr("class", "state-borders")
							.attr("d", path);


						g.counties.append("g")
							.attr("class", "counties")
							.selectAll("path")
							.data(topojson.feature(json, json.objects.counties).features)
							.enter().append("path")
							.attr("d", path);

						g.counties.append("path")
							.attr("class", "county-borders")
							.attr("d", path(topojson.mesh(json, json.objects.counties, function(a, b) { return a !== b; })));

						g.cities.selectAll("circle")
							.data(data)
							.enter()
							.append("circle")
							.attr("class", "city")
							.attr("id", function(d) {
								if (d.id != -1) {
									return "city-" + d.id;
								}

								return "";
							})
							.attr("cx", function(d) {
								if (projection([d.longitude, d.latitude]) == undefined) return;
								return projection([d.longitude, d.latitude])[0];
							})
							.attr("cy", function(d) {
								if (projection([d.longitude, d.latitude]) == undefined) return;
								return projection([d.longitude, d.latitude])[1];
							})
							.attr("r", function(d) {
								return 0.2 + (d["2015-2020-price"] / price.totalMaximun) * 2;
							})
							.style("fill", colorMain)
							.style("stroke", "#fff")
							.style("stroke-width", 0.1)

						g.cities.selectAll("circle").on("mouseover", function(d) {
							d3.select(this).raise();
							d3.select(this).style("fill", colorSecondary);

							const html = `
								<table class="info-table" border="0" cellspacing="0" cellpadding="2">
								<tbody>
								<tr>
								<th>City Name</th>
								<td>${d.name}</td>
								</tr>
								<tr>
								<th>2015 - 2020 Average Price</th>
								<td>${d["2015-2020-price"]}</td>
								</tr>
								<tr>
								<th>2015 - 2020 Count of House Sales</th>
								<td>${d["2015-2020-count"]}</td>
								</tr>
								<tr>
								</tr>
								</tbody>
								</table>
							`;

							body.html(html);
							details.style("visibility", "visible");

							d3.select("#bar-price-" + d.id)
								.style("fill", colorSecondary);
							d3.select("#bar-count-" + d.id)
								.style("fill", colorSecondary);

						});

						g.cities.selectAll("circle").on("mouseout", function(d) {
							d3.select(this).style("fill", colorMain);
							details.style("visibility", "hidden");
							d3.select("#bar-price-" + d.id)
								.style("fill", colorMain);
							d3.select("#bar-count-" + d.id)
								.style("fill", colorMain);
						});
					}

				}

				function drawPanel() {

					let svgWidth = 320;

					drawBarPrice();
					drawBarCount();
					drawLinePrice();
					drawLineCount();
					drawDetail1("Los Altos Hills");

					let panel = d3.select("#panel");
					let barPrice = d3.select("div.bar-price");
					let barCount = d3.select("div.bar-count");
					let linePrice = d3.select("div.line-price");
					let lineCount = d3.select("div.line-count");
					let detail = d3.select("div.details");

					barPrice.style("display", "none");
	//				barCount.style("display", "none");
					linePrice.style("display", "none");
					lineCount.style("display", "none");
					detail.style("display", "none");

					function drawBarPrice() {
						let svgHeight = 1000;

						var margin = {top: 0, right: 20, bottom: 50, left: 110}
						  , width = svgWidth - margin.left - margin.right // Use the window's width 
						  , height = svgHeight - margin.top - margin.bottom;

						let xScale = d3.scaleBand().range([0, width]).padding(0.4);
						let yScale = d3.scaleLinear().range([height, 0]);

						let svg = d3.select("svg#bar-price")
										.attr("width", svgWidth)
										.attr("height", svgHeight)
										.attr("viewBox", "0 0 " + svgWidth + " " + svgHeight);

						var g = svg.append("g")
								.attr("transform", "translate(" + margin.left + "," + margin.top + ")");

						let priceData = data.sort(comparePrice);

						xScale = d3.scaleLinear()
								.domain([0, price.totalMaximun])
								.range([0, width]);

						yScale = d3.scaleBand()
								.domain(priceData.map(function(d) { 
									return d.name;
								}))
								.range([0, height])
								.padding(0.2);

						let xAxis = g.append("g")
							.attr("transform", "translate(0," + height + ")")
							.call(d3.axisBottom(xScale).tickFormat(function(d){
								if (d >= 1000000) {
									return d / 1000000 + "M";
								} else if (d >= 1000) {
									return d / 1000 + "K";
								} else if (d < 1000) {
									return d;
								}
							})
							.ticks(10))
							.attr("class", "x-axis")
							.append("text")
							.attr("class", "label")
							.attr("y", 40)
							.attr("x", width)
							.attr("text-anchor", "end")
							.attr("stroke", "#2d3666")
							.text("Average House Price");

						let yAxis = g.append("g")
							.call(d3.axisLeft(yScale))
							.attr("class", "y-axis")
							.append("text")
							.attr("transform", "rotate(-90)")
							.attr("y", -100)
							.attr("text-anchor", "end")
							.attr("stroke", "#2d3666")
							.attr("class", "label")
							.text("City Names");

						// Create the bars' container
						let bars = g.append("g")
							.attr("class", "bars-price")
							.attr("x", 0)
							.attr("y", 200);

						let bar = bars.selectAll(".bar-price")
							.data(priceData)
							.enter()
							.append("rect")
							.attr("class", "bar-price")
							.attr("id", function(d) {
								if (d.id != -1) {
									return "bar-price-" + d.id;
								}

								return "";
							})
							.attr("x", 0)
							.attr("y", function(d) {
								return yScale(d.name);
							})
							.attr("width", function(d) {
								return xScale(d["2015-2020-price"]);
							})
							.attr("height", yScale.bandwidth())
							.style("fill", colorMain);

						bars.selectAll(".bar-price").on("mouseover", function(d) {
							d3.select(this).style("fill", colorSecondary);

							const html = `
								<table class="info-table" border="0" cellspacing="0" cellpadding="2">
								<tbody>
								<tr>
								<th>City Name</th>
								<td>${d.name}</td>
								</tr>
								<tr>
								<th>2015 - 2020 Average Price</th>
								<td>${d["2015-2020-price"]}</td>
								</tr>
								<tr>
								<th>2015 - 2020 Count of House Sales</th>
								<td>${d["2015-2020-count"]}</td>
								</tr>
								<tr>
								</tr>
								</tbody>
								</table>
							`;

							body.html(html);
							details.style("visibility", "visible");

							d3.select("#city-" + d.id)
								.style("fill", colorSecondary);

						});

						bars.selectAll(".bar-price").on("mouseout", function(d) {
							d3.select(this).style("fill", colorMain);
							details.style("visibility", "hidden");
							d3.select("#city-" + d.id)
								.style("fill", colorMain);
						});
					}

					function drawBarCount() {
						let svgHeight = 1000;

						var margin = {top: 0, right: 0, bottom: 50, left: 110}
						  , width = svgWidth - margin.left - margin.right // Use the window's width 
						  , height = svgHeight - margin.top - margin.bottom;

						let xScale = d3.scaleBand().range([0, width]).padding(0.4);
						let yScale = d3.scaleLinear().range([height, 0]);

						let svg = d3.select("svg#bar-count")
										.attr("width", svgWidth)
										.attr("height", svgHeight)
										.attr("viewBox", "0 0 " + svgWidth + " " + svgHeight);

						var g = svg.append("g")
								.attr("transform", "translate(" + margin.left + "," + margin.top + ")");

						let countData = data.sort(compareCount);

						xScale = d3.scaleLinear()
								.domain([0, count.totalMaximun])
								.range([0, width]);

						yScale = d3.scaleBand()
								.domain(countData.map(function(d) { 
									return d.name;
								}))
								.range([0, height])
								.padding(0.2);

						let xAxis = g.append("g")
							.attr("transform", "translate(0," + height + ")")
							.call(d3.axisBottom(xScale).tickFormat(function(d){
								return d;
							})
							.ticks(10))
							.attr("class", "x-axis")
							.append("text")
							.attr("class", "label")
							.attr("y", 40)
							.attr("x", width)
							.attr("text-anchor", "end")
							.attr("stroke", "#2d3666")
							.text("Count of House Sales");

						let yAxis = g.append("g")
							.call(d3.axisLeft(yScale))
							.attr("class", "y-axis")
							.append("text")
							.attr("transform", "rotate(-90)")
							.attr("y", -100)
							.attr("text-anchor", "end")
							.attr("stroke", "#2d3666")
							.attr("class", "label")
							.text("City Names");

						let bars = g.append("g")
							.attr("class", "bars-count")
							.attr("x", 0)
							.attr("y", 0);

						let bar = bars.selectAll(".bar-count")
							.data(countData)
							.enter()
							.append("rect")
							.attr("class", "bar-count")
							.attr("id", function(d) {
								if (d.id != -1) {
									return "bar-count-" + d.id;
								}

								return "";
							})
							.attr("x", 0)
							.attr("y", function(d) {
								return yScale(d.name);
							})
							.attr("width", function(d) {
								return xScale(d["2015-2020-count"]);
							})
							.attr("height", yScale.bandwidth())
							.style("fill", colorMain);
						
						bars.selectAll(".bar-count").on("mouseover", function(d) {
							d3.select(this).style("fill", colorSecondary);

							const html = `
								<table class="info-table" border="0" cellspacing="0" cellpadding="2">
								<tbody>
								<tr>
								<th>City Name</th>
								<td>${d.name}</td>
								</tr>
								<tr>
								<th>2015 - 2020 Average Price</th>
								<td>${d["2015-2020-price"]}</td>
								</tr>
								<tr>
								<th>2015 - 2020 Count of House Sales</th>
								<td>${d["2015-2020-count"]}</td>
								</tr>
								<tr>
								</tr>
								</tbody>
								</table>
							`;

							body.html(html);
							details.style("visibility", "visible");

							d3.select("#city-" + d.id)
								.style("fill", colorSecondary);

						});

						bars.selectAll(".bar-count").on("mouseout", function(d) {
							d3.select(this).style("fill", colorMain);
							details.style("visibility", "hidden");
							d3.select("#city-" + d.id)
								.style("fill", colorMain);
						});
					}

					function drawLinePrice() {
						let svgHeight = 500;

						var margin = {top: 10, right: 20, bottom: 50, left: 60}
						  , width = svgWidth - margin.left - margin.right // Use the window's width 
						  , height = svgHeight - margin.top - margin.bottom;

						let svg = d3.select("svg#line-price")
										.attr("width", svgWidth)
										.attr("height", svgHeight)
										.attr("viewBox", "0 0 " + svgWidth + " " + svgHeight);

						var g = svg.append("g")
								.attr("transform", "translate(" + margin.left + "," + margin.top + ")");

						let values = [];

						for (let i = 2015; i < 2021; i++) {
							values.push({
								date: i,
								value: price[i]
							});
						}

						let xScale = d3.scaleTime().range([0, width]);

						xScale.domain([d3.min(values, function(d) { return d.date; }), d3.max(values, function(d) { return d.date; })]);

						let yScale = d3.scaleLinear().range([height, 0]);

						yScale.domain([d3.min(values, function(d) { return d.value; }), d3.max(values, function(d) { return d.value; })]);


						var line = d3.line()
							.x(function(d) { return xScale(d.date); }) // set the x values for the line generator
							.y(function(d) { return yScale(d.value); }) // set the y values for the line generator

						let xAxis = g.append("g")
							.attr("transform", "translate(0," + height + ")")
							.call(d3.axisBottom(xScale))
							.attr("class", "x-axis")
							.append("text")
							.attr("class", "label")
							.attr("y", 40)
							.attr("x", width)
							.attr("text-anchor", "end")
							.attr("stroke", "#2d3666")
							.text("Year");

						let yAxis = g.append("g")
							.call(d3.axisLeft(yScale).tickFormat(function(d){
								if (d >= 1000000) {
									return d / 1000000 + "M";
								} else if (d >= 1000) {
									return d / 1000 + "K";
								} else if (d < 1000) {
									return d;
								}
							})
							.ticks(10))
							.attr("class", "y-axis")
							.append("text")
							.attr("transform", "rotate(-90)")
							.attr("y", -50)
							.attr("text-anchor", "end")
							.attr("stroke", "#2d3666")
							.attr("class", "label")
							.text("Average House Price");

						g.append("path")
							.datum(values) // 10. Binds data to the line 
							.attr("class", "line") // Assign a class for styling 
							.attr('fill', 'none')
							.attr('stroke', colorMain)
							.attr('stroke-width', 1.5)
							.attr('d', line);
					}

					function drawLineCount() {
						let svgHeight = 500;

						var margin = {top: 10, right: 20, bottom: 50, left: 60}
						  , width = svgWidth - margin.left - margin.right // Use the window's width 
						  , height = svgHeight - margin.top - margin.bottom;

						let svg = d3.select("svg#line-count")
										.attr("width", svgWidth)
										.attr("height", svgHeight)
										.attr("viewBox", "0 0 " + svgWidth + " " + svgHeight);

						var g = svg.append("g")
								.attr("transform", "translate(" + margin.left + "," + margin.top + ")");

						let values = [];

						for (let i = 2015; i < 2020; i++) {
							values.push({
								date: i,
								value: count[i]
							});
						}

						let xScale = d3.scaleTime().range([0, width]);

						xScale.domain([d3.min(values, function(d) { return d.date; }), d3.max(values, function(d) { return d.date; })]);

						let yScale = d3.scaleLinear().range([height, 0]);

						yScale.domain([d3.min(values, function(d) { return d.value; }), d3.max(values, function(d) { return d.value; })]);

						var line = d3.line()
							.x(function(d) { return xScale(d.date); }) // set the x values for the line generator
							.y(function(d) { return yScale(d.value); }) // set the y values for the line generator

						let xAxis = g.append("g")
							.attr("transform", "translate(0," + height + ")")
							.call(d3.axisBottom(xScale))
							.attr("class", "x-axis")
							.append("text")
							.attr("class", "label")
							.attr("y", 40)
							.attr("x", width)
							.attr("text-anchor", "end")
							.attr("stroke", "#2d3666")
							.text("Year");

						let yAxis = g.append("g")
							.call(d3.axisLeft(yScale).tickFormat(function(d){
								if (d >= 1000000) {
									return d / 1000000 + "M";
								} else if (d >= 1000) {
									return d / 1000 + "K";
								} else if (d < 1000) {
									return d;
								}
							})
							.ticks(10))
							.attr("class", "y-axis")
							.append("text")
							.attr("transform", "rotate(-90)")
							.attr("y", -50)
							.attr("text-anchor", "end")
							.attr("stroke", "#2d3666")
							.attr("class", "label")
							.text("Count of House Sales");

						g.append("path")
							.datum(values) // 10. Binds data to the line 
							.attr("class", "line") // Assign a class for styling 
							.attr('fill', 'none')
							.attr('stroke', colorMain)
							.attr('stroke-width', 1.5)
							.attr('d', line);
					}

					function drawDetail1(city) {
						detailBar1();
						detailBar2();
						detailLine1();
						detailLine2();

						function detailBar1() {
							let svgHeight = 70;

							var margin = {top: 5, right: 20, bottom: 0, left: 20}
							  , width = svgWidth - margin.left - margin.right // Use the window's width 
							  , height = svgHeight - margin.top - margin.bottom;

							let xScale = d3.scaleBand().range([0, width]).padding(0.4);
							let yScale = d3.scaleLinear().range([height, 0]);

							let svg = d3.select("svg#detail-1-bar-1")
											.attr("width", svgWidth)
											.attr("height", svgHeight)
											.attr("viewBox", "0 0 " + svgWidth + " " + svgHeight);

							var g = svg.append("g")
									.attr("transform", "translate(" + margin.left + "," + margin.top + ")");

							let priceData = [records[city]["2015-2020-price"]];

							xScale = d3.scaleLinear()
									.domain([0, price.totalMaximun])
									.range([0, width]);

							yScale = d3.scaleBand()
									.domain(city)
									.range([0, height])
									.padding(0.2);

							let xAxis = g.append("g")
								.attr("transform", "translate(0," + 45 + ")")
								.call(d3.axisBottom(xScale).tickFormat(function(d){
									if (d >= 1000000) {
										return d / 1000000 + "M";
									} else if (d >= 1000) {
										return d / 1000 + "K";
									} else if (d < 1000) {
										return d;
									}
								})
								.ticks(10))
								.attr("class", "x-axis")
								.append("text")
								.attr("class", "label")
								.attr("x", 150)
								.attr("y", -40)
								.attr("text-anchor", "end")
								.attr("stroke", "#2d3666")
								.text("Average House Price (2015-2020)");

							// Create the bars' container
							let bar = g.selectAll(".bar-price")
								.data(priceData)
								.enter()
								.append("rect")
								.attr("class", "bar-price")
								.attr("x", 0)
								.attr("y", 20)
								.attr("width", function(d) {
									return xScale(d);
								})
								.attr("height", 25)
								.style("fill", colorMain);
						}

						function detailBar2() {
							let svgHeight = 70;

							var margin = {top: 5, right: 20, bottom: 0, left: 20}
							  , width = svgWidth - margin.left - margin.right // Use the window's width 
							  , height = svgHeight - margin.top - margin.bottom;

							let xScale = d3.scaleBand().range([0, width]).padding(0.4);
							let yScale = d3.scaleLinear().range([height, 0]);

							let svg = d3.select("svg#detail-1-bar-2")
											.attr("width", svgWidth)
											.attr("height", svgHeight)
											.attr("viewBox", "0 0 " + svgWidth + " " + svgHeight);

							var g = svg.append("g")
									.attr("transform", "translate(" + margin.left + "," + margin.top + ")");

							let countData = [records[city]["2015-2020-count"]];

							xScale = d3.scaleLinear()
									.domain([0, count.totalMaximun])
									.range([0, width]);

							yScale = d3.scaleBand()
									.domain(city)
									.range([0, height])
									.padding(0.2);

							let xAxis = g.append("g")
								.attr("transform", "translate(0," + 45 + ")")
								.call(d3.axisBottom(xScale))
								.attr("class", "x-axis")
								.append("text")
								.attr("class", "label")
								.attr("x", 152)
								.attr("y", -40)
								.attr("text-anchor", "end")
								.attr("stroke", "#2d3666")
								.text("Count of House Sales (2015-2020)");

							// Create the bars' container
							let bar = g.selectAll(".bar-count")
								.data(countData)
								.enter()
								.append("rect")
								.attr("class", "bar-count")
								.attr("x", 0)
								.attr("y", 20)
								.attr("width", function(d) {
									return xScale(d);
								})
								.attr("height", 25)
								.style("fill", colorMain);
						}

						function detailLine1() {
							let svgHeight = 180;

							var margin = {top: 25, right: 20, bottom: 50, left: 60}
							  , width = svgWidth - margin.left - margin.right // Use the window's width 
							  , height = svgHeight - margin.top - margin.bottom;

							let svg = d3.select("svg#detail-1-line-1")
											.attr("width", svgWidth)
											.attr("height", svgHeight)
											.attr("viewBox", "0 0 " + svgWidth + " " + svgHeight);

							var g = svg.append("g")
									.attr("transform", "translate(" + margin.left + "," + margin.top + ")");


							let lineValues = [];

							for (let i = 2015; i < 2021; i++) {
								let value = {
									date: i,
									price: records[city][i + "-price"]
								}

								lineValues.push(value);
							}

							let xScale = d3.scaleTime().range([0, width]);

							xScale.domain([d3.min(lineValues, function(d) { return d.date; }), d3.max(lineValues, function(d) { return d.date; })]);

							let yScale = d3.scaleLinear().range([height, 0]);

							yScale.domain([d3.min(lineValues, function(d) { return d.price; }), d3.max(lineValues, function(d) { return d.price; })]);


							var line = d3.line()
								.x(function(d) { return xScale(d.date); }) // set the x values for the line generator
								.y(function(d) { return yScale(d.price); }) // set the y values for the line generator

							let xAxis = g.append("g")
								.attr("transform", "translate(0," + height + ")")
								.call(d3.axisBottom(xScale))
								.attr("class", "x-axis")
								.append("text")
								.attr("class", "label")
								.attr("y", 40)
								.attr("x", width)
								.attr("text-anchor", "end")
								.attr("stroke", "#2d3666")
								.text("Year");

							let yAxis = g.append("g")
								.call(d3.axisLeft(yScale).tickFormat(function(d){
									if (d >= 1000000) {
										return d / 1000000 + "M";
									} else if (d >= 1000) {
										return d / 1000 + "K";
									} else if (d < 1000) {
										return d;
									}
								})
								.ticks(10))
								.attr("class", "y-axis")
								.append("text")
								.attr("x", 55)
								.attr("y", -15)
								.attr("text-anchor", "end")
								.attr("stroke", "#2d3666")
								.attr("class", "label")
								.text("Average House Price");

							g.append("path")
								.datum(lineValues) // 10. Binds data to the line 
								.attr("class", "line") // Assign a class for styling 
								.attr('fill', 'none')
								.attr('stroke', colorMain)
								.attr('stroke-width', 1.5)
								.attr('d', line);

						}
						function detailLine2() {
							let svgHeight = 180;

							var margin = {top: 25, right: 20, bottom: 50, left: 60}
							  , width = svgWidth - margin.left - margin.right // Use the window's width 
							  , height = svgHeight - margin.top - margin.bottom;

							let svg = d3.select("svg#detail-1-line-2")
											.attr("width", svgWidth)
											.attr("height", svgHeight)
											.attr("viewBox", "0 0 " + svgWidth + " " + svgHeight);

							var g = svg.append("g")
									.attr("transform", "translate(" + margin.left + "," + margin.top + ")");


							let lineValues = [];

							for (let i = 2015; i < 2021; i++) {
								let value = {
									date: i,
									count: records[city][i + "-count"]
								}

								lineValues.push(value);
							}

							let xScale = d3.scaleTime().range([0, width]);

							xScale.domain([d3.min(lineValues, function(d) { return d.date; }), d3.max(lineValues, function(d) { return d.date; })]);

							let yScale = d3.scaleLinear().range([height, 0]);

							yScale.domain([d3.min(lineValues, function(d) { return d.count; }), d3.max(lineValues, function(d) { return d.count; })]);


							var line = d3.line()
								.x(function(d) { return xScale(d.date); }) // set the x values for the line generator
								.y(function(d) { return yScale(d.count); }) // set the y values for the line generator

							let xAxis = g.append("g")
								.attr("transform", "translate(0," + height + ")")
								.call(d3.axisBottom(xScale))
								.attr("class", "x-axis")
								.append("text")
								.attr("class", "label")
								.attr("y", 40)
								.attr("x", width)
								.attr("text-anchor", "end")
								.attr("stroke", "#2d3666")
								.text("Year");

							let yAxis = g.append("g")
								.call(d3.axisLeft(yScale))
								.attr("class", "y-axis")
								.append("text")
								.attr("x", 55)
								.attr("y", -15)
								.attr("text-anchor", "end")
								.attr("stroke", "#2d3666")
								.attr("class", "label")
								.text("Average House Price");

							g.append("path")
								.datum(lineValues) // 10. Binds data to the line 
								.attr("class", "line") // Assign a class for styling 
								.attr('fill', 'none')
								.attr('stroke', colorMain)
								.attr('stroke-width', 1.5)
								.attr('d', line);
						}
					}

					function compareCount(a, b) {
						const countA = a["2015-2020-count"];
						const countB = b["2015-2020-count"];

						let comparison = 0;
						if (countA < countB) {
							comparison = 1;
						} else if (countA > countB) {
							comparison = -1;
						}

						return comparison;
					}

					function comparePrice(a, b) {
						const priceA = a["2015-2020-price"];
						const priceB = b["2015-2020-price"];

						let comparison = 0;
						if (priceA < priceB) {
							comparison = 1;
						} else if (priceA > priceB) {
							comparison = -1;
						}

						return comparison;
					}
				}
			}
			
		</script>
		<script src="../../ui/vendor/jquery.min.js"></script>
		<script src="../../ui/vendor/popper.min.js"></script>
		<script src="../../ui/vendor/bootstrap.min.js"></script>
		<script src="../../ui/vendor/perfect-scrollbar.min.js"></script>
		<script src="../../ui/vendor/hammer.min.js"></script>
		<script src="../../ui/vendor/jquery-ui/jquery-ui.min.js"></script>
		<script src="../../ui/vendor/color/color.min.js"></script>
		<script src="../../ui/vendor/fontawesome.min.js"></script>
		<script src="../../ui/scripts/sidebar.min.js"></script>
		<script src="../../ui/scripts/collapsible-nav.min.js"></script>
		<script src="../../ui/scripts/colors.min.js"></script>
		<script src="../../ui/scripts/settings.min.js"></script>
		<script src="../../ui/scripts/card.min.js"></script>
		<script src="../../ui/scripts/script.js"></script>
	</body>
</html>
